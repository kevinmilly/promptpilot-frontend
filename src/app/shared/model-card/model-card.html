<!-- FULL VIEW -->
<ng-container *ngIf="viewMode === 'full'">
  <mat-card class="model-card" [ngClass]="providerClass(result.metadata.provider)">
    <mat-card-header>
      <mat-card-title>{{ result.metadata.name }}</mat-card-title>
      <mat-card-subtitle>{{ result.metadata.provider }}</mat-card-subtitle>
      <button mat-icon-button class="copy-btn" (click)="copyText(result.text)" matTooltip="Copy response">
        <mat-icon>content_copy</mat-icon>
      </button>
    </mat-card-header>

    <mat-card-content>
      <p class="response-text">{{ result.text }}</p>

      <div class="metrics">
        <div class="metric-row">
          <span>⚡ {{ result.latency }} ms</span>
          <span>💬 {{ result.tokens }} tokens</span>
          <span>
            💰
            {{
            result.insights?.estimatedCostUSD
            ? (result.insights?.estimatedCostUSD | currency : 'USD' : 'symbol' : '1.4-4')
            : 'N/A'
            }}
          </span>
        </div>

        <div class="metric-row">
          <span>
            🧠 Readability:
            <span [class.good]="(result.insights?.readability ?? 0) > 60" [class.medium]="
                (result.insights?.readability ?? 0) > 30 &&
                (result.insights?.readability ?? 0) <= 60
              " [class.bad]="(result.insights?.readability ?? 0) <= 30">
              {{ result.insights?.readability ?? 'N/A' }}
            </span>
          </span>
          <span>🎭 Tone: {{ result.insights?.tone ?? 'N/A' }}</span>
        </div>

        <div class="metric-row">
          <span>🔗 Coherence:</span>
          <mat-progress-bar mode="determinate" [value]="(result.insights?.coherence ?? 0) * 100"
            color="accent"></mat-progress-bar>
        </div>
      </div>
    </mat-card-content>
  </mat-card>
</ng-container>

<!-- COMPACT VIEW -->
<ng-container *ngIf="viewMode === 'compact'">
  <mat-card class="model-card" [ngClass]="[
    providerClass(result.metadata.provider),
    viewMode === 'compact' ? 'compact-mode' : ''
  ]">

    <mat-card-header>
      <mat-card-title>{{ result.metadata.name }}</mat-card-title>
      <mat-card-subtitle>{{ result.metadata.provider }}</mat-card-subtitle>
    </mat-card-header>

    <mat-card-content>
      <div class="metric-row">
        <span>⚡ {{ result.latency }} ms</span>
        <span>🧠 {{ result.insights?.readability ?? 'N/A' }}</span>
        <span>🔗 {{ (result.insights?.coherence ?? 0) * 100 | number : '1.0-0' }}%</span>
      </div>
    </mat-card-content>
  </mat-card>
</ng-container>